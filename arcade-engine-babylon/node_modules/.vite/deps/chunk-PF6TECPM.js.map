{
  "version": 3,
  "sources": ["../../../dev/core/src/Actions/action.ts", "../../../dev/core/src/Actions/directActions.ts"],
  "sourcesContent": ["import { Observable } from \"../Misc/observable\";\r\nimport { Vector2, Vector3 } from \"../Maths/math.vector\";\r\nimport { Color3, Color4 } from \"../Maths/math.color\";\r\nimport type { Condition } from \"./condition\";\r\nimport { RegisterClass } from \"../Misc/typeStore\";\r\nimport type { AbstractActionManager } from \"./abstractActionManager\";\r\nimport type { Nullable } from \"../types\";\r\nimport type { Material } from \"../Materials/material\";\r\n\r\nimport type { Scene } from \"../scene\";\r\nimport type { ActionManager } from \"./actionManager\";\r\nimport type { ActionEvent } from \"./actionEvent\";\r\nimport type { Mesh } from \"../Meshes/mesh\";\r\nimport type { Light } from \"../Lights/light\";\r\nimport type { Camera } from \"../Cameras/camera\";\r\nimport type { Node } from \"../node\";\r\n\r\n/**\r\n * Interface used to define Action\r\n */\r\nexport interface IAction {\r\n    /**\r\n     * Trigger for the action\r\n     */\r\n    trigger: number;\r\n\r\n    /** Options of the trigger */\r\n    triggerOptions: any;\r\n\r\n    /**\r\n     * Gets the trigger parameters\r\n     * @returns the trigger parameters\r\n     */\r\n    getTriggerParameter(): any;\r\n\r\n    /**\r\n     * Internal only - executes current action event\r\n     * @internal\r\n     */\r\n    _executeCurrent(evt?: ActionEvent): void;\r\n\r\n    /**\r\n     * Serialize placeholder for child classes\r\n     * @param parent of child\r\n     * @returns the serialized object\r\n     */\r\n    serialize(parent: any): any;\r\n\r\n    /**\r\n     * Internal only\r\n     * @internal\r\n     */\r\n    _prepare(): void;\r\n\r\n    /**\r\n     * Internal only - manager for action\r\n     * @internal\r\n     */\r\n    _actionManager: Nullable<AbstractActionManager>;\r\n\r\n    /**\r\n     * Adds action to chain of actions, may be a DoNothingAction\r\n     * @param action defines the next action to execute\r\n     * @returns The action passed in\r\n     * @see https://www.babylonjs-playground.com/#1T30HR#0\r\n     */\r\n    then(action: IAction): IAction;\r\n}\r\n\r\n/**\r\n * The action to be carried out following a trigger\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions#available-actions\r\n */\r\nexport class Action implements IAction {\r\n    /**\r\n     * Trigger for the action\r\n     */\r\n    public trigger: number;\r\n\r\n    /**\r\n     * Internal only - manager for action\r\n     * @internal\r\n     */\r\n    public _actionManager: ActionManager;\r\n\r\n    private _nextActiveAction: Action;\r\n    private _child: Action;\r\n    private _condition?: Condition;\r\n    private _triggerParameter: any;\r\n\r\n    /**\r\n     * An event triggered prior to action being executed.\r\n     */\r\n    public onBeforeExecuteObservable = new Observable<Action>();\r\n\r\n    /**\r\n     * Creates a new Action\r\n     * @param triggerOptions the trigger, with or without parameters, for the action\r\n     * @param condition an optional determinant of action\r\n     */\r\n    constructor(\r\n        /** the trigger, with or without parameters, for the action */\r\n        public triggerOptions: any,\r\n        condition?: Condition\r\n    ) {\r\n        if (triggerOptions.parameter) {\r\n            this.trigger = triggerOptions.trigger;\r\n            this._triggerParameter = triggerOptions.parameter;\r\n        } else if (triggerOptions.trigger) {\r\n            this.trigger = triggerOptions.trigger;\r\n        } else {\r\n            this.trigger = triggerOptions;\r\n        }\r\n\r\n        this._nextActiveAction = this;\r\n        this._condition = condition;\r\n    }\r\n\r\n    /**\r\n     * Internal only\r\n     * @internal\r\n     */\r\n    public _prepare(): void {}\r\n\r\n    /**\r\n     * Gets the trigger parameter\r\n     * @returns the trigger parameter\r\n     */\r\n    public getTriggerParameter(): any {\r\n        return this._triggerParameter;\r\n    }\r\n\r\n    /**\r\n     * Sets the trigger parameter\r\n     * @param value defines the new trigger parameter\r\n     */\r\n    public setTriggerParameter(value: any) {\r\n        this._triggerParameter = value;\r\n    }\r\n\r\n    /**\r\n     * Internal only - Returns if the current condition allows to run the action\r\n     * @internal\r\n     */\r\n    public _evaluateConditionForCurrentFrame(): boolean {\r\n        const condition = this._condition;\r\n        if (!condition) {\r\n            return true;\r\n        }\r\n\r\n        const currentRenderId = this._actionManager.getScene().getRenderId();\r\n\r\n        // We cache the current evaluation for the current frame\r\n        if (condition._evaluationId !== currentRenderId) {\r\n            condition._evaluationId = currentRenderId;\r\n            condition._currentResult = condition.isValid();\r\n        }\r\n\r\n        return condition._currentResult;\r\n    }\r\n\r\n    /**\r\n     * Internal only - executes current action event\r\n     * @internal\r\n     */\r\n    public _executeCurrent(evt?: ActionEvent): void {\r\n        const isConditionValid = this._evaluateConditionForCurrentFrame();\r\n        if (!isConditionValid) {\r\n            return;\r\n        }\r\n\r\n        this.onBeforeExecuteObservable.notifyObservers(this);\r\n        this._nextActiveAction.execute(evt);\r\n\r\n        this.skipToNextActiveAction();\r\n    }\r\n\r\n    /**\r\n     * Execute placeholder for child classes\r\n     * @param evt optional action event\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    public execute(evt?: ActionEvent): void {}\r\n\r\n    /**\r\n     * Skips to next active action\r\n     */\r\n    public skipToNextActiveAction(): void {\r\n        if (this._nextActiveAction._child) {\r\n            if (!this._nextActiveAction._child._actionManager) {\r\n                this._nextActiveAction._child._actionManager = this._actionManager;\r\n            }\r\n\r\n            this._nextActiveAction = this._nextActiveAction._child;\r\n        } else {\r\n            this._nextActiveAction = this;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds action to chain of actions, may be a DoNothingAction\r\n     * @param action defines the next action to execute\r\n     * @returns The action passed in\r\n     * @see https://www.babylonjs-playground.com/#1T30HR#0\r\n     */\r\n    public then(action: Action): Action {\r\n        this._child = action;\r\n\r\n        action._actionManager = this._actionManager;\r\n        action._prepare();\r\n\r\n        return action;\r\n    }\r\n\r\n    /**\r\n     * Internal only\r\n     * @internal\r\n     */\r\n    public _getProperty(propertyPath: string): string {\r\n        return this._actionManager._getProperty(propertyPath);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _getEffectiveTarget(target: any, propertyPath: string): any {\r\n        return this._actionManager._getEffectiveTarget(target, propertyPath);\r\n    }\r\n\r\n    /**\r\n     * Serialize placeholder for child classes\r\n     * @param parent of child\r\n     * @returns the serialized object\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    public serialize(parent: any): any {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Internal only called by serialize\r\n     * @internal\r\n     */\r\n    protected _serialize(serializedAction: any, parent?: any): any {\r\n        const serializationObject: any = {\r\n            type: 1,\r\n            children: [],\r\n            name: serializedAction.name,\r\n            properties: serializedAction.properties || [],\r\n        };\r\n\r\n        // Serialize child\r\n        if (this._child) {\r\n            this._child.serialize(serializationObject);\r\n        }\r\n\r\n        // Check if \"this\" has a condition\r\n        if (this._condition) {\r\n            const serializedCondition = this._condition.serialize();\r\n            serializedCondition.children.push(serializationObject);\r\n\r\n            if (parent) {\r\n                parent.children.push(serializedCondition);\r\n            }\r\n            return serializedCondition;\r\n        }\r\n\r\n        if (parent) {\r\n            parent.children.push(serializationObject);\r\n        }\r\n        return serializationObject;\r\n    }\r\n\r\n    /**\r\n     * Internal only\r\n     * @internal\r\n     */\r\n    public static _SerializeValueAsString = (value: any): string => {\r\n        if (typeof value === \"number\") {\r\n            return value.toString();\r\n        }\r\n\r\n        if (typeof value === \"boolean\") {\r\n            return value ? \"true\" : \"false\";\r\n        }\r\n\r\n        if (value instanceof Vector2) {\r\n            return value.x + \", \" + value.y;\r\n        }\r\n        if (value instanceof Vector3) {\r\n            return value.x + \", \" + value.y + \", \" + value.z;\r\n        }\r\n\r\n        if (value instanceof Color3) {\r\n            return value.r + \", \" + value.g + \", \" + value.b;\r\n        }\r\n        if (value instanceof Color4) {\r\n            return value.r + \", \" + value.g + \", \" + value.b + \", \" + value.a;\r\n        }\r\n\r\n        return value; // string\r\n    };\r\n\r\n    /**\r\n     * Internal only\r\n     * @internal\r\n     */\r\n    public static _GetTargetProperty = (target: Scene | Node | Material) => {\r\n        return {\r\n            name: \"target\",\r\n            targetType: (<Mesh>target)._isMesh\r\n                ? \"MeshProperties\"\r\n                : (<Light>target)._isLight\r\n                  ? \"LightProperties\"\r\n                  : (<Camera>target)._isCamera\r\n                    ? \"CameraProperties\"\r\n                    : (<Material>target)._isMaterial\r\n                      ? \"MaterialProperties\"\r\n                      : \"SceneProperties\",\r\n            value: (<Scene>target)._isScene ? \"Scene\" : (<Node>target).name,\r\n        };\r\n    };\r\n}\r\n\r\nRegisterClass(\"BABYLON.Action\", Action);\r\n", "import { Logger } from \"../Misc/logger\";\r\nimport { Vector3 } from \"../Maths/math.vector\";\r\nimport { Action } from \"./action\";\r\nimport type { Condition } from \"./condition\";\r\nimport { Constants } from \"../Engines/constants\";\r\nimport { RegisterClass } from \"../Misc/typeStore\";\r\n\r\nimport type { ActionEvent } from \"./actionEvent\";\r\n\r\n/**\r\n * This defines an action responsible to toggle a boolean once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class SwitchBooleanAction extends Action {\r\n    /**\r\n     * The path to the boolean property in the target object\r\n     */\r\n    public propertyPath: string;\r\n\r\n    private _target: any;\r\n    private _effectiveTarget: any;\r\n    private _property: string;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the object containing the boolean\r\n     * @param propertyPath defines the path to the boolean property in the target object\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, propertyPath: string, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.propertyPath = propertyPath;\r\n        this._target = this._effectiveTarget = target;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {\r\n        this._effectiveTarget = this._getEffectiveTarget(this._effectiveTarget, this.propertyPath);\r\n        this._property = this._getProperty(this.propertyPath);\r\n    }\r\n\r\n    /**\r\n     * Execute the action toggle the boolean value.\r\n     */\r\n    public override execute(): void {\r\n        this._effectiveTarget[this._property] = !this._effectiveTarget[this._property];\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"SwitchBooleanAction\",\r\n                properties: [Action._GetTargetProperty(this._target), { name: \"propertyPath\", value: this.propertyPath }],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to set a the state field of the target\r\n *  to a desired value once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class SetStateAction extends Action {\r\n    /**\r\n     * The value to store in the state field.\r\n     */\r\n    public value: string;\r\n\r\n    private _target: any;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the object containing the state property\r\n     * @param value defines the value to store in the state field\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, value: string, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.value = value;\r\n        this._target = target;\r\n    }\r\n\r\n    /**\r\n     * Execute the action and store the value on the target state property.\r\n     */\r\n    public override execute(): void {\r\n        this._target.state = this.value;\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"SetStateAction\",\r\n                properties: [Action._GetTargetProperty(this._target), { name: \"value\", value: this.value }],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to set a property of the target\r\n *  to a desired value once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class SetValueAction extends Action {\r\n    /**\r\n     * The path of the property to set in the target.\r\n     */\r\n    public propertyPath: string;\r\n\r\n    /**\r\n     * The value to set in the property\r\n     */\r\n    public value: any;\r\n\r\n    private _target: any;\r\n    private _effectiveTarget: any;\r\n    private _property: string;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the object containing the property\r\n     * @param propertyPath defines the path of the property to set in the target\r\n     * @param value defines the value to set in the property\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, propertyPath: string, value: any, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.propertyPath = propertyPath;\r\n        this.value = value;\r\n        this._target = this._effectiveTarget = target;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {\r\n        this._effectiveTarget = this._getEffectiveTarget(this._effectiveTarget, this.propertyPath);\r\n        this._property = this._getProperty(this.propertyPath);\r\n    }\r\n\r\n    /**\r\n     * Execute the action and set the targeted property to the desired value.\r\n     */\r\n    public override execute(): void {\r\n        this._effectiveTarget[this._property] = this.value;\r\n\r\n        if (this._target.markAsDirty) {\r\n            this._target.markAsDirty(this._property);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"SetValueAction\",\r\n                properties: [\r\n                    Action._GetTargetProperty(this._target),\r\n                    { name: \"propertyPath\", value: this.propertyPath },\r\n                    { name: \"value\", value: Action._SerializeValueAsString(this.value) },\r\n                ],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to increment the target value\r\n *  to a desired value once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class IncrementValueAction extends Action {\r\n    /**\r\n     * The path of the property to increment in the target.\r\n     */\r\n    public propertyPath: string;\r\n\r\n    /**\r\n     * The value we should increment the property by.\r\n     */\r\n    public value: any;\r\n\r\n    private _target: any;\r\n    private _effectiveTarget: any;\r\n    private _property: string;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the object containing the property\r\n     * @param propertyPath defines the path of the property to increment in the target\r\n     * @param value defines the value value we should increment the property by\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, propertyPath: string, value: any, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.propertyPath = propertyPath;\r\n        this.value = value;\r\n        this._target = this._effectiveTarget = target;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {\r\n        this._effectiveTarget = this._getEffectiveTarget(this._effectiveTarget, this.propertyPath);\r\n        this._property = this._getProperty(this.propertyPath);\r\n\r\n        if (typeof this._effectiveTarget[this._property] !== \"number\") {\r\n            Logger.Warn(\"Warning: IncrementValueAction can only be used with number values\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Execute the action and increment the target of the value amount.\r\n     */\r\n    public override execute(): void {\r\n        this._effectiveTarget[this._property] += this.value;\r\n\r\n        if (this._target.markAsDirty) {\r\n            this._target.markAsDirty(this._property);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"IncrementValueAction\",\r\n                properties: [\r\n                    Action._GetTargetProperty(this._target),\r\n                    { name: \"propertyPath\", value: this.propertyPath },\r\n                    { name: \"value\", value: Action._SerializeValueAsString(this.value) },\r\n                ],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to start an animation once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class PlayAnimationAction extends Action {\r\n    /**\r\n     * Where the animation should start (animation frame)\r\n     */\r\n    public from: number;\r\n\r\n    /**\r\n     * Where the animation should stop (animation frame)\r\n     */\r\n    public to: number;\r\n\r\n    /**\r\n     * Define if the animation should loop or stop after the first play.\r\n     */\r\n    public loop?: boolean;\r\n\r\n    private _target: any;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the target animation or animation name\r\n     * @param from defines from where the animation should start (animation frame)\r\n     * @param to defines where the animation should stop (animation frame)\r\n     * @param loop defines if the animation should loop or stop after the first play\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, from: number, to: number, loop?: boolean, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.from = from;\r\n        this.to = to;\r\n        this.loop = loop;\r\n        this._target = target;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {}\r\n\r\n    /**\r\n     * Execute the action and play the animation.\r\n     */\r\n    public override execute(): void {\r\n        const scene = this._actionManager.getScene();\r\n        scene.beginAnimation(this._target, this.from, this.to, this.loop);\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"PlayAnimationAction\",\r\n                properties: [\r\n                    Action._GetTargetProperty(this._target),\r\n                    { name: \"from\", value: String(this.from) },\r\n                    { name: \"to\", value: String(this.to) },\r\n                    { name: \"loop\", value: Action._SerializeValueAsString(this.loop) || false },\r\n                ],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to stop an animation once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class StopAnimationAction extends Action {\r\n    private _target: any;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the target animation or animation name\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this._target = target;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {}\r\n\r\n    /**\r\n     * Execute the action and stop the animation.\r\n     */\r\n    public override execute(): void {\r\n        const scene = this._actionManager.getScene();\r\n        scene.stopAnimation(this._target);\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"StopAnimationAction\",\r\n                properties: [Action._GetTargetProperty(this._target)],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible that does nothing once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class DoNothingAction extends Action {\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any = Constants.ACTION_NothingTrigger, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n    }\r\n\r\n    /**\r\n     * Execute the action and do nothing.\r\n     */\r\n    public override execute(): void {}\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"DoNothingAction\",\r\n                properties: [],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to trigger several actions once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class CombineAction extends Action {\r\n    /**\r\n     * The list of aggregated animations to run.\r\n     */\r\n    public children: Action[];\r\n\r\n    /**\r\n     * defines if the children actions conditions should be check before execution\r\n     */\r\n    public enableChildrenConditions: boolean;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param children defines the list of aggregated animations to run\r\n     * @param condition defines the trigger related conditions\r\n     * @param enableChildrenConditions defines if the children actions conditions should be check before execution\r\n     */\r\n    constructor(triggerOptions: any, children: Action[], condition?: Condition, enableChildrenConditions = true) {\r\n        super(triggerOptions, condition);\r\n        this.children = children;\r\n        this.enableChildrenConditions = enableChildrenConditions;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {\r\n        for (let index = 0; index < this.children.length; index++) {\r\n            this.children[index]._actionManager = this._actionManager;\r\n            this.children[index]._prepare();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Execute the action and executes all the aggregated actions.\r\n     * @param evt event to execute\r\n     */\r\n    public override execute(evt: ActionEvent): void {\r\n        for (const action of this.children) {\r\n            if (!this.enableChildrenConditions || action._evaluateConditionForCurrentFrame()) {\r\n                action.execute(evt);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        const serializationObject = super._serialize(\r\n            {\r\n                name: \"CombineAction\",\r\n                properties: [],\r\n                combine: [],\r\n            },\r\n            parent\r\n        );\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            serializationObject.combine.push(this.children[i].serialize(null));\r\n        }\r\n\r\n        return serializationObject;\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to run code (external event) once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class ExecuteCodeAction extends Action {\r\n    /**\r\n     * The callback function to run.\r\n     */\r\n    public func: (evt: ActionEvent) => void;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param func defines the callback function to run\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, func: (evt: ActionEvent) => void, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this.func = func;\r\n    }\r\n\r\n    /**\r\n     * Execute the action and run the attached code.\r\n     * @param evt event to execute\r\n     */\r\n    public override execute(evt: ActionEvent): void {\r\n        this.func(evt);\r\n    }\r\n}\r\n\r\n/**\r\n * This defines an action responsible to set the parent property of the target once triggered.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/events/actions\r\n */\r\nexport class SetParentAction extends Action {\r\n    private _parent: any;\r\n    private _target: any;\r\n\r\n    /**\r\n     * Instantiate the action\r\n     * @param triggerOptions defines the trigger options\r\n     * @param target defines the target containing the parent property\r\n     * @param parent defines from where the animation should start (animation frame)\r\n     * @param condition defines the trigger related conditions\r\n     */\r\n    constructor(triggerOptions: any, target: any, parent: any, condition?: Condition) {\r\n        super(triggerOptions, condition);\r\n        this._target = target;\r\n        this._parent = parent;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _prepare(): void {}\r\n\r\n    /**\r\n     * Execute the action and set the parent property.\r\n     */\r\n    public override execute(): void {\r\n        if (this._target.parent === this._parent) {\r\n            return;\r\n        }\r\n\r\n        const invertParentWorldMatrix = this._parent.getWorldMatrix().clone();\r\n        invertParentWorldMatrix.invert();\r\n\r\n        this._target.position = Vector3.TransformCoordinates(this._target.position, invertParentWorldMatrix);\r\n\r\n        this._target.parent = this._parent;\r\n    }\r\n\r\n    /**\r\n     * Serializes the actions and its related information.\r\n     * @param parent defines the object to serialize in\r\n     * @returns the serialized object\r\n     */\r\n    public override serialize(parent: any): any {\r\n        return super._serialize(\r\n            {\r\n                name: \"SetParentAction\",\r\n                properties: [Action._GetTargetProperty(this._target), Action._GetTargetProperty(this._parent)],\r\n            },\r\n            parent\r\n        );\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.SetParentAction\", SetParentAction);\r\nRegisterClass(\"BABYLON.ExecuteCodeAction\", ExecuteCodeAction);\r\nRegisterClass(\"BABYLON.DoNothingAction\", DoNothingAction);\r\nRegisterClass(\"BABYLON.StopAnimationAction\", StopAnimationAction);\r\nRegisterClass(\"BABYLON.PlayAnimationAction\", PlayAnimationAction);\r\nRegisterClass(\"BABYLON.IncrementValueAction\", IncrementValueAction);\r\nRegisterClass(\"BABYLON.SetValueAction\", SetValueAction);\r\nRegisterClass(\"BABYLON.SetStateAction\", SetStateAction);\r\nRegisterClass(\"BABYLON.SetParentAction\", SetParentAction);\r\nRegisterClass(\"BABYLON.SwitchBooleanAction\", SwitchBooleanAction);\r\nRegisterClass(\"BABYLON.CombineAction\", CombineAction);\r\n"],
  "mappings": "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",
  "names": []
}
